# CVE-2021-40444


# C'est quoi ?

Une vulnérabilité d’exécution de code à distance dans MSHTML qui touche Microsoft Windows. Microsoft a connaissance d’attaques ciblées visant à exploiter cette vulnérabilité en utilisant des documents Microsoft Office spécialement conçus.

Un attaquant pourrait concevoir un contrôle ActiveX malveillant à utiliser par un document Microsoft Office qui héberge le moteur de rendu de navigateur. L’attaquant devrait ensuite convaincre l’utilisateur d’ouvrir le document malveillant. Les utilisateurs dont les comptes sont configurés avec moins de droits sur le système pourraient être moins touchés que ceux qui disposent de privilèges d’administrateur.


## Comment se protéger ?

Tenir à jour les produits anti-programmes malveillants en activant les mises à jour automatiques.

Désactiver l’installation de tous les contrôles ActiveX dans Internet Explorer. Cette opération peut être effectuée pour tous les sites en configurant la stratégie de groupe à l’aide de l’Éditeur de stratégie de groupe locale  **ou**  en procédant à la mise à jour du Registre. Les contrôles ActiveX déjà installés continueront à être exécutés sans exposer cette vulnérabilité.

**Pour désactiver les contrôles ActiveX par l’intermédiaire de la stratégie de groupe**

Dans les paramètres de la stratégie de groupe, accédez à Configuration ordinateur > Modèles d’administration > Composants Windows > Internet Explorer > Panneau de configuration Internet > Onglet Sécurité.

Pour chaque zone :

1.  Sélectionnez la zone (Zone Internet, Zone intranet, Zone Ordinateur local ou Zone Sites approuvés).
2.  Double-cliquez sur  **Télécharger les contrôles ActiveX signés**, puis  **activez**  la stratégie. Définissez ensuite l’option dans la stratégie sur  **Désactivé**.
3.  Double-cliquez sur  **Télécharger les contrôles ActiveX non signés**, puis  **activez**  la stratégie. Définissez ensuite l’option dans la stratégie sur  **Désactivé**.

Il est recommandé d’appliquer ce paramètre à toutes les zones afin d’assurer la protection complète du système.

**Impact de cette solution de contournement.**

Cette procédure définit URLACTION_DOWNLOAD_SIGNED_ACTIVEX (0x1001) et URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX (0x1004) sur DISABLED (3) pour toutes les zones Internet pour les processus 64 bits et 32 bits. Les nouveaux contrôles ActiveX ne seront plus installés. Les contrôles ActiveX déjà installés continueront à être exécutés.

**Procédure d’annulation de la solution de contournement**

Définissez l’option dans la stratégie sur  **Désactivé**.

**Pour désactiver les contrôles ActiveX sur un système par l’intermédiaire d’une clé de Registre**

1.  Pour désactiver l’installation des contrôles ActiveX dans Internet Explorer dans toutes les zones, collez le texte suivant dans un fichier texte et enregistrez-le avec l’extension de fichier .reg :

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\0]
"1001"=dword:00000003
"1004"=dword:00000003

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\1]
"1001"=dword:00000003
"1004"=dword:00000003

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\2]
"1001"=dword:00000003
"1004"=dword:00000003

[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\3]
"1001"=dword:00000003
"1004"=dword:00000003
```
2.  Double-cliquez sur le fichier .reg pour l’appliquer à votre ruche de stratégies.
3.  Redémarrez le système pour vous assurer que la nouvelle configuration a bien été appliquée.

**Impact de cette solution de contournement.**

Cette procédure définit URLACTION_DOWNLOAD_SIGNED_ACTIVEX (0x1001) et URLACTION_DOWNLOAD_UNSIGNED_ACTIVEX (0x1004) sur DISABLED (3) pour toutes les zones Internet pour les processus 64 bits et 32 bits. Les nouveaux contrôles ActiveX ne seront plus installés. Les contrôles ActiveX déjà installés continueront à être exécutés.

**Procédure d’annulation de la solution de contournement**

Supprimez les clés de Registre ajoutées pour l’implémentation de cette solution de contournement.

**Pour désactiver la visualisation dans l’Explorateur Windows**

La désactivation de la visualisation Shell empêche un utilisateur de visualiser les documents dans l’Explorateur Windows. Procédez comme suit pour chaque type de document dont vous souhaitez désactiver la visualisation :

1.  Dans l’Éditeur du Registre, accédez à la clé de Registre appropriée :

Pour les documents Word :

-   HKEY_CLASSES_ROOT.docx\ShellEx{8895b1c6-b41f-4c1c-a562-0d564250836f}
-   HKEY_CLASSES_ROOT.doc\ShellEx{8895b1c6-b41f-4c1c-a562-0d564250836f}
-   HKEY_CLASSES_ROOT.docm\ShellEx{8895b1c6-b41f-4c1c-a562-0d564250836f}

Pour les fichiers RTF :

-   HKEY_CLASSES_ROOT.rtf\ShellEx{8895b1c6-b41f-4c1c-a562-0d564250836f}

2.  Exportez une copie de la clé de Registre à des fins de sauvegarde.
3.  Double-cliquez sur le  **nom**  puis, dans la boîte de dialogue  **Modification de la chaîne**, supprimez les données de la valeur.
4.  Cliquez sur  **OK**.

**Impact de cette solution de contournement**

L’utilisateur ne pourra plus visualiser les documents dans l’Explorateur Windows.

**Procédure d’annulation de la solution de contournement**

Double-cliquez sur le fichier .reg créé à l’étape 2 de la solution de contournement.
